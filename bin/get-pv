#!/bin/bash
#

#TEMPLATE='{{range .items}}{{.metadata.name}}{{"\t"}}{{.status.phase}}/{{.spec.persistentVolumeReclaimPolicy}}{{"\t"}}{{index .metadata.annotations "codefresh.io/backendVolumeTimestamp" }}{{"\t"}}{{index .metadata.labels "repo_name"}}{{"\t"}}{{"\t"}}{{index .metadata.annotations "codefresh.io/usedBy" }}{{"\n"}}{{end}}'

TEMPLATE_GET_PV='{{range .items}}{{.metadata.namespace}}{{"\t"}}{{.metadata.name}}{{"\t"}}{{.spec.storageClassName}}'
TEMPLATE_GET_PV+='{{"\t"}}{{.status.phase}}/{{.spec.persistentVolumeReclaimPolicy}}'
TEMPLATE_GET_PV+='{{"\t"}}{{index .metadata.annotations "codefresh.io/mount-count" }}'
TEMPLATE_GET_PV+='{{"\t"}}{{index .metadata.annotations "codefresh.io/backendVolumeTimestamp" }}'
TEMPLATE_GET_PV+='{{"\t"}}{{index .metadata.creationTimestamp }}'
TEMPLATE_GET_PV+='{{"\t"}}{{index .metadata.labels "repo_name"}}{{"\t"}}{{index .metadata.labels "runtime_env" }}'

TEMPLATE_GET_PV+='{{"\n"}}{{end}}'

kubectl get pv -l codefresh-app=dind -ogo-template="$TEMPLATE_GET_PV"